<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="TransLink Forecasting">
  <link rel="canonical" href="https://translinkforecasting.github.io/rtmdoc/coding_standard/">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Coding Standard - RTM</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../css/extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Coding Standard";
    var mkdocs_page_input_path = "coding_standard.md";
    var mkdocs_page_url = "/rtmdoc/coding_standard/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/rust.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', '', 'auto');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> RTM</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <p class="caption"><span class="caption-text">User Guide</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../workflow/">Model Workflow</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../adv_inputs/">Advanced Inputs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../data_outputs/">Model Data Output</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../data_analysis/">Model Data Analysis</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../data_generate/">Custom Data Generation</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Developer Guide</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../dev_getting_started/">Getting Started</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Coding Standard</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#general-guideline">General Guideline</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#styles">Styles</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#function-abstraction">Function Abstraction</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#data-management">Data Management</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#managing-logging-and-exceptions">Managing Logging and Exceptions</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compliance-and-procedure">Compliance and Procedure</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#code-checking-tool">Code Checking Tool</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#code-review-procedure">Code Review Procedure</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">References</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../reports/">Reports</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../naming_conventions/">Naming Conventions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../data_assumptions/">Data and Assumptions</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">About</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../about/contributing/">Contributing</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">RTM</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Developer Guide &raquo;</li>
        
      
    
    <li>Coding Standard</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="coding-standard">Coding Standard<a class="headerlink" href="#coding-standard" title="Permanent link">&para;</a></h1>
<p>The coding standard for the RTM has two major comonent: guideline and compliance. Coding Standard Guideline spell out the best practices around the design of the RTM code. It is comprised of 3 elements: styles, function abstraction, data management. Following the guideline ensures the programming paradigm used by all developers of the RTM remain the consistent. Code Standard Compliance refers to the set of tools and procedures employed to ensure that the guideline has been met.</p>
<h2 id="general-guideline">General Guideline<a class="headerlink" href="#general-guideline" title="Permanent link">&para;</a></h2>
<h3 id="styles">Styles<a class="headerlink" href="#styles" title="Permanent link">&para;</a></h3>
<ul>
<li>Recommended Code Formator: <a href="https://github.com/google/yapf">google/yapf</a> (yet another python formatter)<ul>
<li>Ensures PEP8 standard is followed</li>
<li>yapf linked with GitHub Action to automatically check for compliance</li>
</ul>
</li>
<li>Key requirements taken from the Python PEP8 Standard:<ul>
<li><strong>Indentation</strong>: spaces are preferred (4 spaces in place of 1 tab)</li>
<li><strong>Maximum Line Length</strong>: 96 characters</li>
<li><strong>Line Break</strong>: occur before binary operators</li>
<li><strong>Blank lines</strong>: surround top-level function and class definitions with two blank lines. Method definitions inside a class are surrounded by a single blank line.</li>
<li><strong>Imports</strong>: separate lines of import starting with standard library, related third party, then local application imports.</li>
<li><strong>Comments</strong>: block comments should explain following code and what and why they do or may be used to section the code.</li>
<li><strong>Docstring (Documentation String)</strong>: docstring is required for all <em>modules</em>, <em>functions</em>, <em>classes</em>, and <em>methods</em>. It should contain short description of what, how, and why the code exists. When applicable, describe the input and output types of the function. For more specific conventions on docstring, see PEP 257.<ul>
<li>You may use extension/tools to generate docstring. For example, <a href="https://marketplace.visualstudio.com/items?itemName=njpwerner.autodocstring">Python Docstring Generator</a> is available for VSCode.</li>
</ul>
</li>
</ul>
</li>
<li>Python Naming Conventions:<ul>
<li><strong>Naming of classes</strong>: CapitalizedWords</li>
<li><strong>Naming of functions and variables</strong>: lower_case_with_underscores<ul>
<li>You may maintain matrix and constant naming conventions when declaring class level variables. For instant variables, lower_case_with_underscores is still preferred.</li>
</ul>
</li>
</ul>
</li>
<li>Data Naming Conventions<ul>
<li><strong>Naming of matrices</strong>: DLTHWRKI1A1 <ul>
<li>see <a href="../naming_conventions/#matrix-names">Matrix Naming Conventions</a> for more</li>
</ul>
</li>
<li><strong>Naming of constants</strong>: C_HWRKBIAS</li>
</ul>
</li>
</ul>
<h3 id="function-abstraction">Function Abstraction<a class="headerlink" href="#function-abstraction" title="Permanent link">&para;</a></h3>
<ul>
<li>If the similar (or identical) routine needs to be done more than once, the routine should be written into a function with appropriate arguments. </li>
<li>If a set of functions is part of a high-order concept, they should be organized into a class, thus, becoming a modular component that can be instantiated.<ul>
<li>An example of a concept that can be organized into a class is the Mode Choice Model. Different function within a class object for Mode Choice can read specification, evaluate mode availabilities, and calculate choice probabilities. Once instantiated, the Mode Choice Model object can be applied to different trips by household segments.</li>
</ul>
</li>
</ul>
<h3 id="data-management">Data Management<a class="headerlink" href="#data-management" title="Permanent link">&para;</a></h3>
<ul>
<li>Intermediate data <ul>
<li>must not be persisted into EMME databank. They may be persisted using fast and lightweight data storage such as <a href="https://arrow.apache.org/docs/python/numpy.html#numpy-to-arrow">arrow for numpy</a> and <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_feather.html">feather for pandas</a>. </li>
<li>should have descriptive names, and when possible, use the fixed length naming convention established in <a href="../naming_conventions/#matrix-names">Matrix Naming Conventions</a>.</li>
<li>should be removed after a model run (unless if running in test/debug mode).</li>
</ul>
</li>
<li>Final output data <ul>
<li>must be stored as EMME matrices, or into the omx data format (see <a href="https://github.com/osPlanning/omx">osPlanning/omx</a>).</li>
<li>must follow fixed length naming conventions based on attribute category, see <a href="../naming_conventions/#matrix-names">Matrix Naming Conventions</a>.</li>
</ul>
</li>
<li>Do not use of legacy EMME matrix numbering system.</li>
<li>Definition of naming of array, matrices, and data tables may be specified with metadata configurations. This is especially useful when a large amount of intermediate data are carried across the modeling process.</li>
</ul>
<h3 id="managing-logging-and-exceptions">Managing Logging and Exceptions<a class="headerlink" href="#managing-logging-and-exceptions" title="Permanent link">&para;</a></h3>
<ul>
<li>Logging level may be modified during development as per need.</li>
<li>Mimimal logging should be used for commits pulled into master or main branch of the RTM.</li>
<li>Error messages and exception handling need to always be reported to logs.</li>
</ul>
<h2 id="compliance-and-procedure">Compliance and Procedure<a class="headerlink" href="#compliance-and-procedure" title="Permanent link">&para;</a></h2>
<p>The code checking tool and code review procedure are used to enforce the guideline. The code checking tool enforces standard rules using automated tools such as <a href="https://github.com/marketplace/actions/github-action-for-pylint">pylint for GitHub</a>. Then, the review procedure is carried out to ensure area of compliance not covered by the code checking tool. The intention of the code checking tool is to minimize the compliance effort, so it will not replace the standard review procedure. If a commit does not meet compliance, it will be rejected by the RTM code maintainer with comments.</p>
<h3 id="code-checking-tool">Code Checking Tool<a class="headerlink" href="#code-checking-tool" title="Permanent link">&para;</a></h3>
<p>Rules covered by PEP8 will be automatically checked upon any commit to the main RTM repository (feature to be launched on the main RTM repository at a future date).</p>
<h3 id="code-review-procedure">Code Review Procedure<a class="headerlink" href="#code-review-procedure" title="Permanent link">&para;</a></h3>
<p>The code review procedure is to be conducted after the initiation of a Pull Request into any protected branches. For a commit to a non-protected branch, developers do not need to conform to the guideline for ease of development, testing and debugging. However, protected branches such as “master” will be checked for compliance. At least 1 approver review by an RTM maintainer (typically the Project Manager) is needed. If more than 1 deviation has been found, the commit is to be rejected with comments. No comments are required for any approved commits.</p>
<!-- Links -->
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../reports/" class="btn btn-neutral float-right" title="Reports">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../dev_getting_started/" class="btn btn-neutral" title="Getting Started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2020 TransLink Forecasting</p>
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/TransLinkForecasting/rtmdoc" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../dev_getting_started/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../reports/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
